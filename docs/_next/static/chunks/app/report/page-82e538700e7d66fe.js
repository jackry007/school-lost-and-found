(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[81,731],{63:(e,t,s)=>{"use strict";var a=s(7260);s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},1289:(e,t,s)=>{"use strict";s.d(t,{N:()=>a});let a=(0,s(1993).UU)("https://ogqjfeumqaaxorxrehxd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9ncWpmZXVtcWFheG9yeHJlaHhkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk5MzcxOTUsImV4cCI6MjA3NTUxMzE5NX0.5EgofBpIzK_MyB4fRnTSLCxP3nMCznR5PIJ3kD0xjPk")},6230:(e,t,s)=>{"use strict";s.d(t,{default:()=>o});var a=s(5155),l=s(2115),i=s(63),n=s(1289);let r=["Clothing","Electronics","Accessories","Bags","Books","Keys","IDs / Cards","Bottle","Misc"],c=["image/jpeg","image/png","image/webp","image/heic","image/heif"];function o(){let e=(0,i.useRouter)(),[t,s]=(0,l.useState)(!1),[o,u]=(0,l.useState)(null),[m,d]=(0,l.useState)(null);async function p(t){t.preventDefault(),u(null),s(!0);let a=new FormData(t.currentTarget),l=String(a.get("title")||"").trim(),i=String(a.get("location_found")||"").trim(),r=String(a.get("category")||"Misc").trim()||"Misc",o=String(a.get("date_found")||"").trim(),m=String(a.get("notes")||"").trim(),d=a.get("photo");if(!l){u("Please enter a title."),s(!1);return}if(!o){u("Please select the date the item was found."),s(!1);return}if(d&&d.size>0){let e=d.size/1048576;if(e>5){u("Image is too large (".concat(e.toFixed(1)," MB). Max ").concat(5," MB.")),s(!1);return}if(c.length&&d.type&&!c.includes(d.type)){u("Unsupported image type. Please upload JPG/PNG/WebP/HEIC."),s(!1);return}}let p=null;if(d&&d.size>0)try{let e=(d.name.split(".").pop()||"jpg").toLowerCase(),t="public/".concat(Date.now(),"-").concat(Math.random().toString(36).slice(2),".").concat(e),{error:s}=await n.N.storage.from("item-photos").upload(t,d,{cacheControl:"3600",upsert:!1,contentType:d.type||void 0});if(s)throw s;p=t}catch(e){u("Photo upload failed: ".concat((null==e?void 0:e.message)||e)),s(!1);return}try{let{error:e}=await n.N.from("items").insert([{title:l,location_found:i,category:r,date_found:o,status:"listed",photo_url:p,notes:m}]);if(e)throw e}catch(e){u("Could not save item: ".concat((null==e?void 0:e.message)||e)),s(!1);return}e.push("/?posted=1")}return(0,a.jsxs)("form",{onSubmit:p,className:"space-y-4",children:[o&&(0,a.jsx)("div",{className:"rounded-lg border border-red-600/40 bg-red-900/10 p-3 text-sm text-red-400",children:o}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsxs)("label",{className:"block",children:[(0,a.jsx)("span",{className:"mb-1 block text-sm font-medium",children:"Title *"}),(0,a.jsx)("input",{name:"title",required:!0,placeholder:"e.g., Black North Face Jacket",className:"input w-full"})]}),(0,a.jsxs)("label",{className:"block",children:[(0,a.jsx)("span",{className:"mb-1 block text-sm font-medium",children:"Category"}),(0,a.jsx)("select",{name:"category",defaultValue:"Misc",className:"input w-full",children:r.map(e=>(0,a.jsx)("option",{value:e,children:e},e))})]}),(0,a.jsxs)("label",{className:"block",children:[(0,a.jsx)("span",{className:"mb-1 block text-sm font-medium",children:"Location found"}),(0,a.jsx)("input",{name:"location_found",placeholder:"e.g., Library 2F",className:"input w-full"})]}),(0,a.jsxs)("label",{className:"block",children:[(0,a.jsx)("span",{className:"mb-1 block text-sm font-medium",children:"Date found *"}),(0,a.jsx)("input",{type:"date",name:"date_found",required:!0,defaultValue:new Date().toISOString().slice(0,10),className:"input w-full"})]})]}),(0,a.jsxs)("label",{className:"block",children:[(0,a.jsx)("span",{className:"mb-1 block text-sm font-medium",children:"Notes (optional)"}),(0,a.jsx)("textarea",{name:"notes",rows:3,placeholder:"Any identifying details, where exactly you left it, etc.",className:"input w-full"})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-[1fr,200px] md:items-start",children:[(0,a.jsxs)("label",{className:"block",children:[(0,a.jsx)("span",{className:"mb-1 block text-sm font-medium",children:"Photo (optional)"}),(0,a.jsx)("input",{type:"file",name:"photo",accept:"image/*",className:"input w-full",onChange:e=>{var t;let s=null==(t=e.currentTarget.files)?void 0:t[0];s?d(URL.createObjectURL(s)):d(null)}}),(0,a.jsxs)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:["JPG/PNG/WebP/HEIC, up to ",5,"MB."]})]}),m&&(0,a.jsx)("div",{className:"overflow-hidden rounded-lg border border-gray-200 dark:border-gray-700",children:(0,a.jsx)("img",{src:m,alt:"Preview",className:"block h-40 w-full object-cover"})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 pt-2",children:[(0,a.jsx)("button",{type:"submit",className:"btn",disabled:t,children:t?"Submitting...":"Submit Report"}),(0,a.jsx)("button",{type:"button",className:"btn btn-outline",onClick:()=>history.back(),disabled:t,children:"Cancel"})]})]})}},8379:(e,t,s)=>{Promise.resolve().then(s.bind(s,6230))}},e=>{e.O(0,[993,441,255,358],()=>e(e.s=8379)),_N_E=e.O()}]);