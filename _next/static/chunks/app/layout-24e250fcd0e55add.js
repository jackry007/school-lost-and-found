(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{1289:(e,t,s)=>{"use strict";s.d(t,{N:()=>r});let r=(0,s(1993).UU)("https://ogqjfeumqaaxorxrehxd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9ncWpmZXVtcWFheG9yeHJlaHhkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk5MzcxOTUsImV4cCI6MjA3NTUxMzE5NX0.5EgofBpIzK_MyB4fRnTSLCxP3nMCznR5PIJ3kD0xjPk")},3673:()=>{},5274:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var r=s(5155),a=s(2115),l=s(7650),n=s(1289);function i(e){var t;let{open:s,claim:i,onClose:o,meIsStaff:c,currentUid:d}=e,[u,m]=(0,a.useState)([]),[x,h]=(0,a.useState)(""),[f,g]=(0,a.useState)(!1),[b,p]=(0,a.useState)(!1),y=(0,a.useRef)(null),w=(0,a.useRef)(null),j=null!=(t=null==i?void 0:i.id)?t:null,v=e=>c?"claimant"===e||"student"===e:"staff"===e;async function N(e){await n.N.rpc("mark_thread_seen",{p_claim_id:e,p_uid:d})}async function _(){if(!j)return;let e=x.trim();if(!e||b)return;p(!0),h("");let t=Date.now(),s={id:t,claim_id:j,sender_uid:d,sender_role:c?"staff":"claimant",body:e,created_at:new Date().toISOString(),seen_by_claimant:!c,seen_by_staff:!!c,_temp:!0,_error:null};m(e=>[...e,s]);let{data:r,error:a}=await n.N.from("claim_messages").insert({claim_id:j,sender_uid:d,sender_role:s.sender_role,body:e,seen_by_staff:!!c,seen_by_claimant:!c}).select("*").single();if(a||!r){m(e=>e.map(e=>e.id===t?{...e,_error:(null==a?void 0:a.message)||"Failed"}:e)),p(!1);return}m(e=>e.map(e=>e.id===t?r:e)),p(!1)}(0,a.useEffect)(()=>{if(!s)return;let e=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=e}},[s]),(0,a.useEffect)(()=>{if(!s||!j)return;let e=!1;return(async()=>{let{data:t,error:s}=await n.N.from("claim_messages").select("*").eq("claim_id",j).order("created_at",{ascending:!0});e||s||!t||m(t),await N(j);let r=n.N.channel("claim_messages:".concat(j)).on("postgres_changes",{event:"INSERT",schema:"public",table:"claim_messages",filter:"claim_id=eq.".concat(j)},async e=>{let t=e.new;m(e=>[...e,t]),t.sender_uid!==d&&v(t.sender_role)&&await N(j)}).subscribe(t=>{e||"SUBSCRIBED"!==t||g(!0)});return()=>{n.N.removeChannel(r)}})(),()=>{e=!0,g(!1)}},[s,j,d,c]),(0,a.useEffect)(()=>{if(!s||!j||0===u.length)return;let e=u[u.length-1];e.sender_uid!==d&&v(e.sender_role)&&N(j)},[u.length,s,j,d]),(0,a.useEffect)(()=>{var e;null==(e=y.current)||e.scrollIntoView({block:"end"})},[u.length]),(0,a.useEffect)(()=>{var e;if(!s)return;null==(e=w.current)||e.focus();let t=e=>"Escape"===e.key&&o();return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[s,o]),(0,a.useLayoutEffect)(()=>{let e=w.current;e&&(e.style.height="0px",e.style.height=Math.min(120,e.scrollHeight)+"px")},[x]);let k=(0,a.useMemo)(()=>f?"Live":"Connecting…",[f]);if(!s||!i)return null;let C=(0,r.jsxs)("div",{className:"fixed inset-0 z-[1000]",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:o,"aria-hidden":"true"}),(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center p-4",children:(0,r.jsxs)("div",{role:"dialog","aria-modal":"true","aria-labelledby":"chat-modal-title",className:" w-full max-w-lg max-h-[min(90vh,800px)] overflow-hidden rounded-2xl border border-gray-200 bg-white shadow-2xl grid grid-rows-[auto,1fr,auto] ",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between bg-gradient-to-r from-[#b10015] to-[#0f2741] px-4 py-3 text-white",children:[(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsxs)("h3",{id:"chat-modal-title",className:"truncate text-base font-semibold",children:["Messages — Claim #",i.id," (Item #",i.item_id,")"]}),(0,r.jsx)("div",{className:"mt-0.5 truncate text-xs text-white/80",children:i.claimant_name||i.claimant_email||"Student"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)("span",{className:"inline-flex items-center rounded-full px-2 py-0.5 text-[11px] ".concat(f?"bg-white/20":"bg-white/10"),title:"Realtime status",children:[(0,r.jsx)("span",{className:"mr-1 inline-block h-2 w-2 rounded-full ".concat(f?"bg-emerald-300":"bg-amber-300 animate-pulse")}),k]}),(0,r.jsx)("button",{className:"rounded-full bg-white/10 px-3 py-1.5 text-sm text-white hover:bg-white/20",onClick:o,children:"Close"})]})]}),(0,r.jsx)("div",{className:"px-4 py-3 overflow-hidden",children:(0,r.jsxs)("div",{className:"h-full overflow-y-auto rounded-xl border bg-white p-3",style:{maxHeight:"56vh",scrollBehavior:"smooth"},children:[0===u.length&&(0,r.jsx)("div",{className:"py-8 text-center text-sm text-gray-500",children:"No messages yet."}),u.map(e=>{let t=e.sender_uid===d;return(0,r.jsx)("div",{className:"mb-2 flex ".concat(t?"justify-end":"justify-start"),children:(0,r.jsxs)("div",{className:"max-w-[75%] rounded-2xl px-3 py-2 text-sm shadow-sm ".concat(t?"bg-blue-600 text-white":"bg-gray-100 text-gray-900"),children:[(0,r.jsx)("div",{className:"whitespace-pre-wrap break-words",children:e.body}),(0,r.jsxs)("div",{className:"mt-1 text-[10px] ".concat(t?"text-white/80":"text-gray-500"),children:[function(e){let t=new Date(e);if(Number.isNaN(+t))return e;let s=new Date;return t.getFullYear()===s.getFullYear()&&t.getMonth()===s.getMonth()&&t.getDate()===s.getDate()?t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):t.toLocaleString()}(e.created_at),e._temp&&!e._error&&" \xb7 sending…",e._error&&(0,r.jsx)("span",{className:"ml-1 text-rose-400",children:"\xb7 failed"})]})]})},e.id)}),(0,r.jsx)("div",{ref:y})]})}),(0,r.jsxs)("div",{className:"border-t bg-white px-4 py-3",children:[(0,r.jsxs)("div",{className:"flex items-end gap-2",children:[(0,r.jsx)("textarea",{ref:w,value:x,onChange:e=>h(e.target.value),onKeyDown:e=>{"Enter"===e.key&&!e.shiftKey&&(e.preventDefault(),b||_())},placeholder:"Type a message…  (Enter to send, Shift+Enter for newline)",className:"w-full resize-none rounded-xl border border-gray-300 bg-white px-3 py-2 text-sm text-gray-900 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500",rows:1,maxLength:4e3}),(0,r.jsx)("button",{onClick:_,className:"rounded-xl bg-black px-4 py-2 text-sm font-medium text-white disabled:opacity-60",disabled:b||0===x.trim().length,children:b?"Sending…":"Send"})]}),(0,r.jsxs)("div",{className:"mt-1 flex items-center justify-between text-[11px] text-gray-500",children:[(0,r.jsxs)("span",{children:["Press ",(0,r.jsx)("kbd",{className:"rounded border px-1",children:"Enter"})," to send"]}),(0,r.jsxs)("span",{className:"text-gray-400",children:[x.length.toLocaleString(),"/4,000"]})]})]})]})})]});return(0,l.createPortal)(C,document.body)}},6324:(e,t,s)=>{"use strict";s.d(t,{Header:()=>g});var r=s(5155),a=s(2619),l=s.n(a),n=s(63),i=s(2115),o=s(6651),c=s(5229),d=s(1289),u=s(8661),m=s.n(u),x=s(5274);function h(){let[e,t]=(0,i.useState)(""),[s,a]=(0,i.useState)(null),[l,n]=(0,i.useState)(!1),[o,c]=(0,i.useState)([]),[u,h]=(0,i.useState)({}),[f,g]=(0,i.useState)({}),[b,p]=(0,i.useState)({}),[y,w]=(0,i.useState)({}),[j,v]=(0,i.useState)(!1),[N,_]=(0,i.useState)(null),[k,C]=(0,i.useState)(""),S=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250,[s,r]=(0,i.useState)(e);return(0,i.useEffect)(()=>{let s=setTimeout(()=>r(e),t);return()=>clearTimeout(s)},[e,t]),s}(k,200),[E,A]=(0,i.useState)("all"),[I,L]=(0,i.useState)(!1),[D,F]=(0,i.useState)("new"),[M,R]=(0,i.useState)(-1),U=(0,i.useRef)(null),B=(0,i.useRef)(null),q=(0,i.useRef)(null),H="admin"===s||"staff"===s;(0,i.useEffect)(()=>{(async()=>{var e,s,r;let{data:l}=await d.N.auth.getUser(),n=null!=(s=null==(e=l.user)?void 0:e.id)?s:"";if(t(n),!n)return;let{data:i}=await d.N.from("profiles").select("role").eq("uid",n).single();a(null!=(r=null==i?void 0:i.role)?r:"user")})()},[]),(0,i.useEffect)(()=>{if(!e||!s)return;let t=!0;return(async()=>{let s=d.N.from("claims").select("id,item_id,claimant_name,claimant_email,status,created_at,claimant_uid").order("created_at",{ascending:!1});H||(s=s.eq("claimant_uid",e));let{data:r,error:a}=await s;if(a||!r||!t)return;c(r.slice(0,300));let l={};for(let e of r)l[Number(e.id)]=e;h(l);let n=r.map(e=>Number(e.id));if(0===n.length){g({}),w({}),p({});return}let{data:i}=await d.N.from("claim_messages").select("id,claim_id,body,created_at,seen_by_claimant,seen_by_staff,sender_role").in("claim_id",n).order("created_at",{ascending:!1}),o={},u={},m={};(i||[]).forEach(e=>{let t=Number(e.claim_id);o[t]||(o[t]=e.body,u[t]=e.created_at);let s="claimant"===e.sender_role||"student"===e.sender_role;(H?!s||e.seen_by_staff:"staff"!==e.sender_role||e.seen_by_claimant)||(m[t]=(m[t]||0)+1)}),g(o),p(u),w(m)})(),()=>{t=!1}},[e,s,H]),(0,i.useEffect)(()=>{if(!e)return;let t=d.N.channel("claim_msg_portal_rx").on("postgres_changes",{event:"INSERT",schema:"public",table:"claim_messages"},t=>{let s=t.new,r=Number(s.claim_id);g(e=>({...e,[r]:s.body})),p(e=>({...e,[r]:s.created_at}));let a=s.sender_uid===e,l="claimant"===s.sender_role||"student"===s.sender_role,n=H?l:"staff"===s.sender_role;!a&&n&&w(e=>({...e,[r]:(e[r]||0)+1}))}).subscribe();return()=>{d.N.removeChannel(t)}},[e,H]);let z=(0,i.useCallback)(async e=>{let t=H?"seen_by_staff":"seen_by_claimant";await d.N.from("claim_messages").update({[t]:!0}).eq("claim_id",e).eq(t,!1)},[H]);function O(e){_(e),v(!0),w(t=>({...t,[Number(e.id)]:0})),z(Number(e.id)),n(!1)}let P=(0,i.useCallback)(async t=>{let s=u[t];if(s)return O(s);let r=d.N.from("claims").select("id,item_id,claimant_name,claimant_email,status,created_at,claimant_uid").eq("id",t).limit(1);H||(r=r.eq("claimant_uid",e));let{data:a}=await r;a&&a[0]&&O(a[0])},[u,e,H]);(0,i.useEffect)(()=>{let t=new URL(window.location.href);if(!t||!e||!s)return;let r=t.searchParams.get("openClaim"),a=t.searchParams.get("chat");if(r){let e=Number(r);Number.isNaN(e)||(n(!0),P(e))}else if("1"===a){let e=t.pathname.match(/\/claim\/(\d+)(?:\/|$)/);if(e){let t=Number(e[1]);Number.isNaN(t)||(n(!0),P(t))}}},[e,s,P]),(0,i.useEffect)(()=>{let e=e=>{let t=e.detail,s=Number(null==t?void 0:t.claimId);Number.isNaN(s)||(n(!0),P(s))};return window.addEventListener("cc:open-claim",e),()=>window.removeEventListener("cc:open-claim",e)},[P]),(0,i.useEffect)(()=>{if(!l)return;let e=e=>{var t,s;let r=e.target;(null==(t=B.current)||!t.contains(r))&&(null!=(s=U.current)&&s.contains(r)||n(!1))};return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}},[l]);let J=(0,i.useMemo)(()=>{let e=S.trim().toLowerCase(),t=o.filter(t=>("all"===E||(t.status||"").toLowerCase()===E)&&(!I||!!y[Number(t.id)])&&(!e||["#".concat(t.id),t.claimant_name||"",t.claimant_email||"",String(t.item_id||""),t.status||""].join(" ").toLowerCase().includes(e)));return t.sort((e,t)=>{let s=Number(e.id),r=Number(t.id),a=b[s]||e.created_at,l=b[r]||t.created_at;if("unread"===D){let e=+!!y[s],t=+!!y[r];return t!==e?t-e:(l?+new Date(l):0)-(a?+new Date(a):0)}return"old"===D?(a?+new Date(a):0)-(l?+new Date(l):0):(l?+new Date(l):0)-(a?+new Date(a):0)}),t},[o,S,E,I,D,y,b]);(0,i.useEffect)(()=>{if(!l)return;let e=e=>{J.length&&("ArrowDown"===e.key?(e.preventDefault(),R(e=>Math.min(J.length-1,e+1))):"ArrowUp"===e.key?(e.preventDefault(),R(e=>Math.max(0,e-1))):"Enter"===e.key?M>=0&&O(J[M]):"Escape"===e.key&&n(!1))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[l,J,M]),(0,i.useEffect)(()=>{if(M<0||!q.current)return;let e=q.current.querySelectorAll("li")[M];null==e||e.scrollIntoView({block:"nearest"})},[M]);let T="\n    .messages-portal select,\n    .messages-portal input,\n    .messages-portal textarea { color:#111 !important; background:#fff !important; }\n    .messages-portal input::placeholder { color:#6b7280 !important; }\n    .messages-portal .avatar { background:linear-gradient(135deg,#f3f4f6,#e5e7eb); }\n  ";return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m(),{id:T.__hash,children:T}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("button",{ref:U,onClick:()=>{n(e=>!e),R(-1)},title:"Messages",className:"inline-flex items-center gap-2 rounded-full px-4 py-2 text-sm font-medium border border-white/30 bg-white/10 hover:bg-white/20 text-white focus:outline-none focus:ring-2 focus:ring-white/60 transition",children:["Messages",Object.values(y).reduce((e,t)=>e+t,0)>0&&(0,r.jsx)("span",{className:"ml-2 rounded-full bg-red-600 px-2 py-0.5 text-xs text-white",children:Object.values(y).reduce((e,t)=>e+t,0)})]}),l&&(0,r.jsxs)("div",{ref:B,className:"messages-portal fixed right-4 top-16 z-[70] w-[420px] max-w-[92vw] overflow-hidden rounded-2xl border border-gray-200 bg-white shadow-2xl",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between border-b px-4 py-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-sm font-semibold text-gray-900",children:"Inbox"}),(0,r.jsx)("span",{className:"rounded-full bg-gray-100 px-2 py-0.5 text-[11px] text-gray-700",children:o.length})]}),(0,r.jsx)("button",{onClick:()=>n(!1),className:"rounded-full border border-gray-200 bg-white px-3 py-1.5 text-sm hover:bg-gray-50",children:"Close"})]}),(0,r.jsxs)("div",{className:"sticky top-0 space-y-2 border-b bg-white px-4 py-3",children:[(0,r.jsx)("input",{placeholder:"Search (name, email, #id, status)…",value:k,onChange:e=>C(e.target.value),className:"w-full rounded-xl border border-gray-200 px-3 py-1.5 text-sm text-gray-900 placeholder-gray-500"}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[["all","pending","approved","rejected"].map(e=>(0,r.jsx)("button",{onClick:()=>A(e),style:E===e?{background:"linear-gradient(135deg, #b10015 0%, #0f2741 100%)"}:void 0,className:["rounded-full px-3 py-1 text-xs border",E===e?"text-white border-transparent":"text-gray-700 border-gray-200 bg-white hover:bg-gray-50"].join(" ")||"",children:e[0].toUpperCase()+e.slice(1)},e)),(0,r.jsxs)("div",{className:"ml-auto flex items-center gap-2",children:[(0,r.jsxs)("label",{className:"inline-flex cursor-pointer items-center gap-2 text-xs text-gray-700",children:[(0,r.jsx)("input",{type:"checkbox",checked:I,onChange:e=>L(e.target.checked),className:"h-4 w-4"}),"Unread only"]}),(0,r.jsxs)("select",{value:D,onChange:e=>F(e.target.value),className:"rounded-lg border border-gray-200 bg-white px-2 py-1 text-xs text-gray-900",children:[(0,r.jsx)("option",{value:"new",children:"Newest activity"}),(0,r.jsx)("option",{value:"old",children:"Oldest activity"}),(0,r.jsx)("option",{value:"unread",children:"Unread first"})]})]})]})]}),(0,r.jsxs)("div",{className:"max-h-[65vh] overflow-auto",children:[!J.length&&(0,r.jsx)("div",{className:"px-4 py-10 text-center text-sm text-gray-500",children:"No conversations."}),(0,r.jsx)("ul",{ref:q,className:"divide-y divide-gray-100",children:J.map((e,t)=>{let s=Number(e.id),a=f[s]||"No messages yet",l=y[s]||0,n=H?e.claimant_name||e.claimant_email||"Student":"Staff • Claim #".concat(s),i=function(e,t){let s=(null!=e?e:"").trim();if(s)return s.split(/\s+/).slice(0,2).map(e=>{var t;return(null==(t=e[0])?void 0:t.toUpperCase())||""}).join("")||"U";let r=(null!=t?t:"").trim();return r?r[0].toUpperCase():"U"}(e.claimant_name,e.claimant_email),o=b[s]||e.created_at||"",c=t===M;return(0,r.jsx)("li",{children:(0,r.jsxs)("button",{onClick:()=>O(e),className:["flex w-full items-center gap-3 px-4 py-3 text-left",c?"bg-indigo-50":"hover:bg-gray-50"].join(" ")||"",children:[(0,r.jsx)("div",{className:"avatar flex h-9 w-9 shrink-0 items-center justify-center rounded-full border border-gray-200 text-[12px] font-semibold text-gray-700",children:i}),(0,r.jsxs)("div",{className:"min-w-0 grow",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"truncate text-sm font-semibold text-gray-900",children:n}),H&&(0,r.jsx)("span",{className:"shrink-0 rounded-full px-2 py-0.5 text-[11px] ".concat(function(e){let t=(null!=e?e:"").toLowerCase();return"pending"===t?"bg-amber-100 text-amber-800":"approved"===t?"bg-emerald-100 text-emerald-800":"rejected"===t?"bg-rose-100 text-rose-800":"claimed"===t?"bg-violet-100 text-violet-800":"listed"===t?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-700"}(e.status)),children:e.status||"—"}),(0,r.jsx)("span",{className:"ml-auto text-[11px] text-gray-500",children:function(e){if(!e)return"";let t=Math.max(1,Math.floor((Date.now()-new Date(e).getTime())/1e3)),s=Math.floor(t/60),r=Math.floor(s/60),a=Math.floor(r/24);return a>6?new Date(e).toLocaleDateString():a>=1?"".concat(a,"d"):r>=1?"".concat(r,"h"):s>=1?"".concat(s,"m"):"".concat(t,"s")}(o)})]}),H&&e.claimant_email&&(0,r.jsx)("div",{className:"truncate text-[11px] text-gray-500",children:e.claimant_email}),(0,r.jsx)("div",{className:"truncate text-xs text-gray-600",children:a})]}),(0,r.jsxs)("div",{className:"ml-2 shrink-0 space-y-1 text-right",children:[(0,r.jsxs)("div",{className:"rounded-full bg-gray-100 px-2 py-0.5 text-[11px] text-gray-700",children:["#",s]}),l>0&&(0,r.jsx)("div",{className:"rounded-full bg-red-600 px-2 py-0.5 text-[11px] font-semibold text-white",children:l})]})]})},s)})})]})]})]}),j&&N&&(0,r.jsx)(x.A,{open:j,claim:N,onClose:()=>v(!1),meIsStaff:H,currentUid:e})]})}let f="cc-lostfound-notice:nextShowAt:v1";function g(){let e=(0,n.usePathname)(),[t,s]=(0,i.useState)(!1),[a,u]=(0,i.useState)(null),[m,x]=(0,i.useState)("loading"),[g,b]=(0,i.useState)(null),[p,y]=(0,i.useState)(null),[w,j]=(0,i.useState)(!1),v=(0,i.useRef)(null),[N,_]=(0,i.useState)(""),[k,C]=(0,i.useState)(""),[S,E]=(0,i.useState)(!1),[A,I]=(0,i.useState)(null);async function L(e){var t;e.preventDefault(),I(null),E(!0);let{error:s}=await d.N.auth.signInWithPassword({email:N.trim(),password:k});if(E(!1),s)return void I(s.message);let{data:r}=await d.N.auth.getUser(),a=null==(t=r.user)?void 0:t.id;if(a){let{data:e}=await d.N.from("profiles").select("role").eq("uid",a).single();(null==e?void 0:e.role)&&y(e.role)}_(""),C(""),j(!1)}async function D(){await d.N.auth.signOut(),window.location.reload()}(0,i.useEffect)(()=>{let e=()=>s(window.scrollY>6);return e(),window.addEventListener("scroll",e,{passive:!0}),()=>window.removeEventListener("scroll",e)},[]),(0,i.useEffect)(()=>{u(function(){let e=window.localStorage.getItem(f);if(!e)return!0;let t=parseInt(e,10)||0;return Date.now()>=t}())},[]),(0,i.useEffect)(()=>{(async()=>{var e,t,s,r;let{data:a}=await d.N.auth.getSession(),l=null!=(t=null==(e=a.session)?void 0:e.user)?t:null;if(x(l?"authed":"guest"),b(null!=(s=null==l?void 0:l.email)?s:null),!l)return;let{data:n}=await d.N.from("profiles").select("role").eq("uid",l.id).single();y(null!=(r=null==n?void 0:n.role)?r:"user")})();let{data:e}=d.N.auth.onAuthStateChange((e,t)=>{var s,r;let a=null!=(s=null==t?void 0:t.user)?s:null;x(a?"authed":"guest"),b(null!=(r=null==a?void 0:a.email)?r:null),a&&j(!1)});return()=>e.subscription.unsubscribe()},[]),(0,i.useEffect)(()=>{if(w)return window.addEventListener("mousedown",e),()=>window.removeEventListener("mousedown",e);function e(e){v.current&&(v.current.contains(e.target)||j(!1))}},[w]);let F=(0,i.useMemo)(()=>[{href:"/",label:"Lost & Found"},{href:"/report",label:"Report Found Item"},..."admin"===p||"staff"===p?[{href:"/admin",label:"Admin"}]:[]],[p]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("header",{className:["sticky top-0 z-40 text-white transition-all duration-300",t?"shadow-[0_6px_18px_rgba(0,0,0,.18)]":"shadow-[0_10px_28px_rgba(0,0,0,.12)]"].join(" "),style:{background:"linear-gradient(180deg, rgba(191,30,46,0.96) 0%, rgba(168,21,36,0.96) 100%)",backdropFilter:"saturate(120%) blur(6px)",WebkitBackdropFilter:"saturate(120%) blur(6px)",borderBottom:"1px solid rgba(0,0,0,.18)"},children:[(0,r.jsxs)("div",{className:["mx-auto flex max-w-7xl items-center justify-between px-4 sm:px-6 lg:px-8",t?"h-14":"h-16"].join(" "),children:[(0,r.jsxs)("div",{className:"flex items-center gap-7",children:[(0,r.jsxs)(l(),{href:"/",className:"group flex items-center gap-3 rounded-lg px-2 py-1 transition no-underline decoration-0","aria-label":"Cherry Creek Lost & Found Home",children:[(0,r.jsx)("span",{className:"text-2xl leading-none",children:"\uD83C\uDF92"}),(0,r.jsxs)("div",{className:"leading-tight",children:[(0,r.jsx)("div",{className:"text-[16px] font-extrabold tracking-tight",children:"Cherry Creek"}),(0,r.jsx)("div",{className:"text-[12px] font-medium text-white/90",children:"Lost & Found"})]})]}),(0,r.jsx)("nav",{className:"hidden md:flex items-center gap-1.5",children:F.map(t=>{let s=e===t.href;return(0,r.jsxs)(l(),{href:t.href,"aria-current":s?"page":void 0,className:["relative group rounded-full px-4 py-2 text-sm font-semibold transition no-underline decoration-0",s?"bg-yellow-400 text-red-900 shadow-[inset_0_-2px_0_rgba(0,0,0,.25)]":"text-white/90 hover:bg-white/15 hover:text-white"].join(" "),children:[t.label,(0,r.jsx)("span",{className:["pointer-events-none absolute left-1/2 -translate-x-1/2 -bottom-1 h-[3px] w-10 rounded-full transition-all",s?"opacity-100 scale-100":"opacity-0 scale-50 group-hover:opacity-100 group-hover:scale-100"].join(" "),style:{backgroundColor:s?"#6E0F16":"rgba(255,255,255,.9)"}})]},t.href)})})]}),(0,r.jsxs)("div",{className:"relative flex items-center gap-3",children:[(0,r.jsxs)(l(),{href:"/search",className:"inline-flex items-center gap-2 rounded-full px-4 py-2 text-sm font-medium border border-white/30 bg-white/10 hover:bg-white/18 focus:outline-none focus:ring-2 focus:ring-white/60 transition","aria-label":"Search items",title:"Search items",children:[(0,r.jsx)(o.A,{size:18}),(0,r.jsx)("span",{className:"hidden sm:inline",children:"Search"})]}),"loading"===m&&(0,r.jsx)("span",{className:"rounded-full px-3 py-2 text-sm border border-white/30 bg-white/10",children:"Checking…"}),"guest"===m&&(0,r.jsxs)("div",{className:"relative",ref:v,children:[(0,r.jsx)("button",{type:"button",onClick:()=>j(e=>!e),className:"inline-flex items-center gap-2 rounded-full px-4 py-2 text-sm font-medium border border-white/30 bg-white/10 hover:bg-white/18 focus:outline-none focus:ring-2 focus:ring-white/60 transition","aria-expanded":w,"aria-controls":"login-panel",children:"Sign in"}),w&&(0,r.jsxs)("div",{id:"login-panel",className:"absolute right-0 mt-2 w-80 rounded-2xl border border-white/25 bg-white/95 text-gray-900 shadow-xl backdrop-blur p-4",children:[(0,r.jsx)("h3",{className:"text-sm font-semibold text-gray-800",children:"Sign in to claim items"}),(0,r.jsxs)("p",{className:"mt-1 text-xs text-gray-600",children:["Use your ",(0,r.jsx)("b",{children:"@cherrycreekschools.org"})," email."]}),(0,r.jsxs)("form",{onSubmit:L,className:"mt-3 space-y-2",children:[(0,r.jsx)("input",{type:"email",value:N,onChange:e=>_(e.target.value),placeholder:"you@cherrycreekschools.org",required:!0,className:"w-full rounded-xl border border-gray-300 px-3 py-2 text-sm outline-none focus:ring-2"}),(0,r.jsx)("input",{type:"password",value:k,onChange:e=>C(e.target.value),placeholder:"Password",required:!0,className:"w-full rounded-xl border border-gray-300 px-3 py-2 text-sm outline-none focus:ring-2"}),A&&(0,r.jsx)("div",{className:"rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-xs text-red-700",children:A}),(0,r.jsx)("button",{type:"submit",disabled:S,className:"w-full rounded-xl bg-[#BF1E2E] px-4 py-2 text-sm font-semibold text-white shadow-sm transition active:scale-[0.99] disabled:opacity-60",children:S?"Signing in…":"Sign In"})]}),(0,r.jsx)("button",{className:"absolute right-2 top-2 rounded p-1 text-gray-500 hover:bg-gray-100","aria-label":"Close",onClick:()=>j(!1),children:(0,r.jsx)(c.A,{size:16})})]})]}),"authed"===m&&(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(h,{}),(0,r.jsx)("span",{className:"max-w-[170px] truncate rounded-full border border-white/30 bg-white/10 px-3 py-2 text-sm",title:null!=g?g:"",children:g}),(0,r.jsx)("button",{onClick:D,className:"rounded-full border border-white/30 bg-white/10 px-3 py-2 text-sm hover:bg-white/18 transition",title:"Sign out",children:"Log out"})]})]})]}),(0,r.jsx)("div",{className:"h-0.5 w-full",style:{backgroundColor:"".concat("#0B2C5C","EE")}})]}),(0,r.jsx)("div",{className:"h-8 w-full shadow-[inset_0_-1px_0_rgba(0,0,0,.08)]",style:{background:"repeating-linear-gradient(135deg, #BF1E2E 0 16px, #0B2C5C 16px 32px)"}}),!0===a&&(0,r.jsxs)("div",{role:"region","aria-label":"Important notice",className:"relative bg-yellow-50 border-y border-yellow-200 text-center text-sm sm:text-base text-yellow-900 py-2 pl-4 pr-12 shadow-sm transition-opacity duration-300 ease-out",children:["⚠️ ",(0,r.jsx)("span",{className:"font-semibold",children:"Important Notice:"})," Items unclaimed after ",(0,r.jsx)("strong",{children:"60 days"})," may be donated or disposed of according to school policy.",(0,r.jsx)("button",{type:"button","aria-label":"Dismiss important notice",onClick:()=>{u(!1);try{window.localStorage.setItem(f,String(Date.now()+864e5))}catch(e){}},className:"absolute right-2 top-1/2 -translate-y-1/2 inline-flex items-center justify-center rounded-md p-2 text-yellow-900/80 hover:text-yellow-900 hover:bg-yellow-100 focus:outline-none focus:ring-2 focus:ring-yellow-400/60 transition",title:"Dismiss",children:(0,r.jsx)(c.A,{size:18,"aria-hidden":"true"})})]})]})}},7282:(e,t,s)=>{"use strict";s.d(t,{default:()=>o});var r=s(5155),a=s(5239),l=s(2619),n=s.n(l);let i={src:"/school-lost-and-found//_next/static/media/cherry-creek-logo.ebdda876.png",height:273,width:253,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAICAMAAAAC2hU0AAAAQlBMVEU6KV4QXJoLXJ0daKWZFRkgbqyoDwqlERESXZx+ISkWWplmJkEPYqKmEg+iBgYZVY1nHzgxS38rR38AdtMAZLWdKS2rjozMAAAAFnRSTlMBmReLq3VEMy8jYGq3VHlugk5SKUK5yzDmBAAAAAlwSFlzAAALEwAACxMBAJqcGAAAADtJREFUeJwVyksWwCAIwMCoIKBt7ff+V+0jm9kEcK1krl4hyjaaR1raCvp8h86OffdziUGXU/b87TD4ASm6AXYgAQLkAAAAAElFTkSuQmCC",blurWidth:7,blurHeight:8};function o(){return(0,r.jsx)("div",{className:"border-b border-gray-200 bg-white",children:(0,r.jsxs)("div",{className:"flex w-full items-center justify-between pl-0 pr-8 lg:pr-12 py-6",children:[(0,r.jsxs)(n(),{href:"/",className:"flex items-center gap-6 no-underline","aria-label":"Cherry Creek High School Home",children:[(0,r.jsx)(a.default,{src:i,alt:"Cherry Creek High School logo",className:"h-28 w-auto",priority:!0}),(0,r.jsxs)("div",{className:"leading-tight select-none",children:[(0,r.jsx)("div",{className:"text-4xl font-extrabold tracking-tight text-[#BF1E2E]",children:"CHERRY CREEK"}),(0,r.jsx)("div",{className:"text-3xl font-semibold text-[#BF1E2E]",children:"HIGH SCHOOL"})]})]}),(0,r.jsx)("div",{className:"hidden sm:block w-[100px]"})]})})}},8417:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,3673,23)),Promise.resolve().then(s.bind(s,8455)),Promise.resolve().then(s.bind(s,6324)),Promise.resolve().then(s.bind(s,7282))},8455:(e,t,s)=>{"use strict";s.d(t,{default:()=>u});var r=s(5155),a=s(8661),l=s.n(a),n=s(5239),i=s(2619),o=s.n(i),c=s(2115);let d="#1E407A";function u(){let e=(0,c.useMemo)(()=>new Date().getFullYear(),[]),t="color-mix(in oklab, ".concat("#0B2C5C"," 88%, white)");return(0,r.jsxs)("footer",{"aria-label":"Site footer",className:"jsx-3cb9385013cb0e3f mt-16 border-t border-black/10 bg-white text-gray-700 dark:border-white/10 dark:bg-neutral-900 dark:text-neutral-200",children:[(0,r.jsx)("div",{style:{background:"linear-gradient(90deg,#BF1E2E 0%,#0B2C5C 100%)"},"aria-hidden":"true",className:"jsx-3cb9385013cb0e3f h-1 w-full"}),(0,r.jsxs)("div",{className:"jsx-3cb9385013cb0e3f mx-auto max-w-7xl px-4 py-10 sm:px-6 lg:px-8",children:[(0,r.jsxs)("div",{className:"jsx-3cb9385013cb0e3f grid gap-12 md:grid-cols-[1.2fr_1fr_1fr] md:items-start",children:[(0,r.jsxs)("section",{"aria-labelledby":"footer-branding",className:"jsx-3cb9385013cb0e3f",children:[(0,r.jsx)("h2",{id:"footer-branding",className:"jsx-3cb9385013cb0e3f sr-only",children:"About this site"}),(0,r.jsxs)("div",{className:"jsx-3cb9385013cb0e3f flex items-start gap-4",children:[(0,r.jsx)(o(),{href:"/",className:"shrink-0 rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2",style:{"--tw-ring-color":t},children:(0,r.jsx)(n.default,{src:"/images/cherry-creek-logo.png",alt:"Cherry Creek High School logo",width:88,height:88,className:"h-22 w-22 rounded-md",priority:!0})}),(0,r.jsxs)("div",{className:"jsx-3cb9385013cb0e3f max-w-prose",children:[(0,r.jsx)("p",{className:"jsx-3cb9385013cb0e3f text-lg font-extrabold text-gray-900 dark:text-white",children:"Cherry Creek HS — Lost & Found"}),(0,r.jsx)("p",{className:"jsx-3cb9385013cb0e3f mt-1 text-sm text-gray-600 dark:text-neutral-400",children:"Find or return lost items quickly and securely."}),(0,r.jsxs)("dl",{className:"jsx-3cb9385013cb0e3f mt-3 text-sm",children:[(0,r.jsxs)("div",{className:"jsx-3cb9385013cb0e3f mt-1",children:[(0,r.jsx)("dt",{className:"jsx-3cb9385013cb0e3f inline font-medium",children:"Pickup:"})," ",(0,r.jsx)("dd",{className:"jsx-3cb9385013cb0e3f inline",children:"Main Office \xb7 Mon–Fri, 7:30a–3:30p"})]}),(0,r.jsxs)("div",{className:"jsx-3cb9385013cb0e3f mt-1",children:[(0,r.jsx)("dt",{className:"jsx-3cb9385013cb0e3f inline font-medium",children:"Contact:"})," ",(0,r.jsx)("dd",{className:"jsx-3cb9385013cb0e3f inline",children:(0,r.jsx)(o(),{href:"mailto:lostfound@cherrycreekschools.org",className:"underline underline-offset-2 hover:no-underline focus:outline-none focus:ring-2 focus:ring-offset-2 rounded-md",style:{"--tw-ring-color":t},children:"lostfound@cherrycreekschools.org"})})]})]})]})]})]}),(0,r.jsxs)("nav",{"aria-labelledby":"footer-help",className:"jsx-3cb9385013cb0e3f text-sm",children:[(0,r.jsx)("h2",{id:"footer-help",className:"jsx-3cb9385013cb0e3f font-semibold text-gray-900 dark:text-white",children:"Help"}),(0,r.jsx)("ul",{className:"jsx-3cb9385013cb0e3f mt-3 space-y-2",children:[["FAQ","/faq"],["Help Center","/help"],["Accessibility","/accessibility"],["Contact","/contact"]].map(e=>{let[s,a]=e;return(0,r.jsx)("li",{className:"jsx-3cb9385013cb0e3f",children:(0,r.jsx)(o(),{href:a,className:"rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 underline-offset-2 hover:underline",style:{"--tw-ring-color":t,color:"oklch(35% 0.06 255)"},children:s})},a)})})]}),(0,r.jsxs)("nav",{"aria-labelledby":"footer-policies",className:"jsx-3cb9385013cb0e3f text-sm",children:[(0,r.jsx)("h2",{id:"footer-policies",className:"jsx-3cb9385013cb0e3f font-semibold text-gray-900 dark:text-white",children:"Policies"}),(0,r.jsx)("ul",{className:"jsx-3cb9385013cb0e3f mt-3 space-y-2",children:[["Privacy","/privacy"],["Terms of Use","/terms"],["Safety & Reporting","/safety"]].map(e=>{let[s,a]=e;return(0,r.jsx)("li",{className:"jsx-3cb9385013cb0e3f",children:(0,r.jsx)(o(),{href:a,className:"rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 underline-offset-2 hover:underline",style:{"--tw-ring-color":t},children:s})},a)})})]})]}),(0,r.jsx)("div",{"aria-hidden":"true",className:"jsx-3cb9385013cb0e3f my-8 h-px w-full bg-gray-200 dark:bg-neutral-800"}),(0,r.jsxs)("div",{className:"jsx-3cb9385013cb0e3f flex flex-col items-start justify-between gap-3 md:flex-row md:items-center",children:[(0,r.jsx)("nav",{"aria-label":"Footer quick actions",className:"jsx-3cb9385013cb0e3f text-sm",children:(0,r.jsxs)("ul",{className:"jsx-3cb9385013cb0e3f flex flex-wrap items-center gap-x-5 gap-y-2",children:[(0,r.jsx)("li",{className:"jsx-3cb9385013cb0e3f",children:(0,r.jsx)(o(),{href:"/report",className:"rounded-md px-3 py-1.5 font-medium text-white shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2",style:{backgroundColor:"#BF1E2E","--tw-ring-color":t},children:"Report Found Item"})}),(0,r.jsx)("li",{className:"jsx-3cb9385013cb0e3f",children:(0,r.jsx)(o(),{href:"/search",className:"rounded-md underline underline-offset-2 hover:no-underline focus:outline-none focus:ring-2 focus:ring-offset-2",style:{"--tw-ring-color":t},children:"Browse Items"})}),(0,r.jsx)("li",{"aria-hidden":!0,className:"jsx-3cb9385013cb0e3f h-5 w-px bg-gray-300 dark:bg-neutral-700"}),(0,r.jsx)("li",{className:"jsx-3cb9385013cb0e3f",children:(0,r.jsx)("a",{href:"#top",style:{"--tw-ring-color":t},className:"jsx-3cb9385013cb0e3f rounded-md underline underline-offset-2 hover:no-underline focus:outline-none focus:ring-2 focus:ring-offset-2",children:"Back to top"})})]})}),(0,r.jsxs)("p",{className:"jsx-3cb9385013cb0e3f text-xs text-gray-500 dark:text-neutral-500",children:["\xa9 ",e," Cherry Creek High School. All rights reserved."]})]})]}),(0,r.jsx)("script",{type:"application/ld+json",suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:JSON.stringify({"@context":"https://schema.org","@type":"Organization",name:"Cherry Creek High School Lost & Found",email:"lostfound@cherrycreekschools.org",url:"https://your-domain.example",logo:"/images/cherry-creek-logo.png"})},className:"jsx-3cb9385013cb0e3f"}),(0,r.jsx)(l(),{id:"3cb9385013cb0e3f",children:"@media(prefers-color-scheme:dark){footer a{color:".concat(d,"}footer a:hover{color:").concat(d,";text-decoration:underline}}")})]})}}},e=>{e.O(0,[978,993,619,456,441,255,358],()=>e(e.s=8417)),_N_E=e.O()}]);