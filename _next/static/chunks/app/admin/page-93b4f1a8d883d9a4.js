(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{1289:(e,s,t)=>{"use strict";t.d(s,{N:()=>a});let a=(0,t(1993).UU)("https://ogqjfeumqaaxorxrehxd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9ncWpmZXVtcWFheG9yeHJlaHhkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk5MzcxOTUsImV4cCI6MjA3NTUxMzE5NX0.5EgofBpIzK_MyB4fRnTSLCxP3nMCznR5PIJ3kD0xjPk")},2563:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>d});var a=t(5155),i=t(2115),l=t(1289);function d(){let[e,s]=(0,i.useState)(null),[t,d]=(0,i.useState)([]),[r,n]=(0,i.useState)([]),c=async()=>{var e;let{data:t}=await l.N.auth.getUser(),a=null==(e=t.user)?void 0:e.id;if(!a){location.href="/auth/login";return}let{data:i,error:r}=await l.N.from("profiles").select("role").eq("uid",a).single();if(r||!i||!["admin","staff"].includes(i.role)){alert("Not authorized"),location.href="/";return}s(i.role);let{data:c}=await l.N.from("items").select("*").order("created_at",{ascending:!1});d(c||[]);let{data:m}=await l.N.from("claims").select("*").order("created_at",{ascending:!1});n(m||[])};(0,i.useEffect)(()=>{c()},[]);let m=async(e,s)=>{let{error:t}=await l.N.from("claims").update({status:s}).eq("id",e);if(t)return alert(t.message);c()},o=async e=>{let{error:s}=await l.N.from("items").update({status:"claimed"}).eq("id",e);if(s)return alert(s.message);c()};return(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold",children:"Admin Dashboard"}),(0,a.jsxs)("section",{children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Pending Claims"}),(0,a.jsxs)("div",{className:"space-y-2",children:[r.filter(e=>"pending"===e.status).map(e=>(0,a.jsxs)("div",{className:"border rounded-xl p-3 flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-sm",children:["Claim #",e.id," for Item #",e.item_id," by"," ",(0,a.jsx)("strong",{children:e.claimant_name})," (",e.claimant_email,")"]}),e.proof&&(0,a.jsxs)("div",{className:"text-xs text-gray-600",children:["Proof: ",e.proof]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{className:"px-3 py-1 border rounded",onClick:()=>m(e.id,"approved"),children:"Approve"}),(0,a.jsx)("button",{className:"px-3 py-1 border rounded",onClick:()=>m(e.id,"rejected"),children:"Reject"})]})]},e.id)),0===r.filter(e=>"pending"===e.status).length&&(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"No pending claims."})]})]}),(0,a.jsxs)("section",{children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Items"}),(0,a.jsx)("div",{className:"grid gap-2",children:t.map(e=>(0,a.jsxs)("div",{className:"border rounded-xl p-3 flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"font-medium",children:["#",e.id," \xb7 ",e.title]}),(0,a.jsxs)("div",{className:"text-xs text-gray-600",children:["Status: ",e.status]})]}),(0,a.jsx)("div",{className:"flex gap-2",children:"listed"===e.status&&(0,a.jsx)("button",{className:"px-3 py-1 border rounded",onClick:()=>o(e.id),children:"Mark Claimed"})})]},e.id))})]})]})}},5882:(e,s,t)=>{Promise.resolve().then(t.bind(t,2563))}},e=>{e.O(0,[993,441,255,358],()=>e(e.s=5882)),_N_E=e.O()}]);