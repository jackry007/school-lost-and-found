(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{63:(e,s,a)=>{"use strict";var t=a(7260);a.o(t,"usePathname")&&a.d(s,{usePathname:function(){return t.usePathname}}),a.o(t,"useRouter")&&a.d(s,{useRouter:function(){return t.useRouter}}),a.o(t,"useSearchParams")&&a.d(s,{useSearchParams:function(){return t.useSearchParams}})},1289:(e,s,a)=>{"use strict";a.d(s,{N:()=>t});let t=(0,a(1993).UU)("https://ogqjfeumqaaxorxrehxd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9ncWpmZXVtcWFheG9yeHJlaHhkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk5MzcxOTUsImV4cCI6MjA3NTUxMzE5NX0.5EgofBpIzK_MyB4fRnTSLCxP3nMCznR5PIJ3kD0xjPk")},2563:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>d});var t=a(5155),i=a(2115),r=a(63),l=a(1289);function d(){let e=(0,r.useRouter)(),[s,a]=(0,i.useState)(null),[d,n]=(0,i.useState)([]),[c,o]=(0,i.useState)([]),m=async()=>{var s;let{data:t}=await l.N.auth.getUser(),i=null==(s=t.user)?void 0:s.id;if(!i)return void e.replace("/auth/login");let{data:r,error:d}=await l.N.from("profiles").select("role").eq("uid",i).single();if(d||!r||!["admin","staff"].includes(r.role)){alert("Not authorized"),e.replace("/");return}a(r.role);let{data:c}=await l.N.from("items").select("*").order("created_at",{ascending:!1});n(c||[]);let{data:m}=await l.N.from("claims").select("*").order("created_at",{ascending:!1});o(m||[])};(0,i.useEffect)(()=>{m()},[]);let u=async()=>{await l.N.auth.signOut(),a(null),n([]),o([]),e.replace("/")},x=async(e,s)=>{let{error:a}=await l.N.from("claims").update({status:s}).eq("id",e);if(a)return alert(a.message);m()},h=async e=>{let{error:s}=await l.N.from("items").update({status:"claimed"}).eq("id",e);if(s)return alert(s.message);m()};return(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h1",{className:"text-2xl font-semibold",children:"Admin Dashboard"}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[s&&(0,t.jsxs)("span",{className:"text-xs rounded-full px-2 py-1 border",children:["Signed in as ",(0,t.jsx)("strong",{children:s})]}),(0,t.jsx)("button",{onClick:u,className:"px-3 py-1 rounded border hover:bg-gray-50",children:"Sign out"})]})]}),(0,t.jsxs)("section",{children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Pending Claims"}),(0,t.jsxs)("div",{className:"space-y-2",children:[c.filter(e=>"pending"===e.status).map(e=>(0,t.jsxs)("div",{className:"border rounded-xl p-3 flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"text-sm",children:["Claim #",e.id," for Item #",e.item_id," by"," ",(0,t.jsx)("strong",{children:e.claimant_name})," (",e.claimant_email,")"]}),e.proof&&(0,t.jsxs)("div",{className:"text-xs text-gray-600",children:["Proof: ",e.proof]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{className:"px-3 py-1 border rounded",onClick:()=>x(e.id,"approved"),children:"Approve"}),(0,t.jsx)("button",{className:"px-3 py-1 border rounded",onClick:()=>x(e.id,"rejected"),children:"Reject"})]})]},e.id)),0===c.filter(e=>"pending"===e.status).length&&(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"No pending claims."})]})]}),(0,t.jsxs)("section",{children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Items"}),(0,t.jsx)("div",{className:"grid gap-2",children:d.map(e=>(0,t.jsxs)("div",{className:"border rounded-xl p-3 flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"font-medium",children:["#",e.id," \xb7 ",e.title]}),(0,t.jsxs)("div",{className:"text-xs text-gray-600",children:["Status: ",e.status]})]}),(0,t.jsx)("div",{className:"flex gap-2",children:"listed"===e.status&&(0,t.jsx)("button",{className:"px-3 py-1 border rounded",onClick:()=>h(e.id),children:"Mark Claimed"})})]},e.id))})]})]})}},7495:(e,s,a)=>{Promise.resolve().then(a.bind(a,2563))}},e=>{e.O(0,[993,441,255,358],()=>e(e.s=7495)),_N_E=e.O()}]);