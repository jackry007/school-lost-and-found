(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[959],{63:(e,t,r)=>{"use strict";var a=r(7260);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},1289:(e,t,r)=>{"use strict";r.d(t,{N:()=>a});let a=(0,r(1993).UU)("https://ogqjfeumqaaxorxrehxd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9ncWpmZXVtcWFheG9yeHJlaHhkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk5MzcxOTUsImV4cCI6MjA3NTUxMzE5NX0.5EgofBpIzK_MyB4fRnTSLCxP3nMCznR5PIJ3kD0xjPk")},1651:(e,t,r)=>{"use strict";r.d(t,{default:()=>v});var a=r(5155),l=r(6278),s=r(2115),n=r(63),o=r(2619),i=r.n(o),d=r(1289),c=r(4642);let u="#BF1E2E",m="#0B2C5C",g=["Clothing","Electronics","Accessories","Bags","Books","Keys","IDs / Cards","Bottle","Misc"];function x(e){var t,r,o,i,d;let{initial:c}=e,x=(0,n.useRouter)();(0,n.useSearchParams)();let h=(0,s.useRef)(null),[f,b]=(0,s.useState)((null!=(t=c.category)?t:[]).filter(Boolean)),p=(0,s.useMemo)(()=>c.q&&c.q.length>0||f.length>0||c.location&&c.location.length>0||c.date_from&&c.date_from.length>0||c.date_to&&c.date_to.length>0||"oldest"===c.sort,[c,f]),y=(0,s.useCallback)(e=>{let t=new FormData(e),r=new URLSearchParams;for(let[e,a]of t.entries())a&&("category"===e?r.append("category",String(a)):r.set(e,String(a)));let a=r.toString();return a?"/search?".concat(a):"/search"},[]),v=(0,s.useCallback)(e=>{let t=e.currentTarget;x.replace(y(t))},[x,y]),j=()=>{b([]);let e=h.current;e&&(e.reset(),Array.from(e.querySelectorAll('input[type="hidden"][name="category"]')).forEach(e=>e.remove()),x.replace("/search"))},w=encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' width='18' height='18'><circle cx='1' cy='1' r='1' fill='".concat(m,"22'/></svg>"));return(0,a.jsx)("aside",{className:"w-full md:w-64 md:sticky md:top-16 self-start",children:(0,a.jsxs)("div",{className:"rounded-3xl p-5 shadow-[0_10px_30px_rgba(0,0,0,.05)] bg-white dark:bg-gray-900",style:{backgroundImage:'url("data:image/svg+xml,'.concat(w,'")'),backgroundColor:"#fafbff"},children:[(0,a.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("svg",{width:"22",height:"26",viewBox:"0 0 24 28","aria-hidden":!0,children:[(0,a.jsx)("path",{d:"M12 0l10 4v8c0 7-5 12-10 16C7 24 2 19 2 12V4l10-4z",fill:u}),(0,a.jsx)("path",{d:"M12 3l7 2v6c0 5-4 9-7 12-3-3-7-7-7-12V5l7-2z",fill:"white",opacity:".95"}),(0,a.jsx)("path",{d:"M12 4.5l5 1.5v5c0 4-3.2 7-5 8.8-1.8-1.8-5-4.8-5-8.8v-5l5-1.5z",fill:m})]}),(0,a.jsx)("h2",{className:"text-base font-semibold",style:{color:m},children:"Filters"})]}),p&&(0,a.jsx)("button",{type:"button",onClick:j,className:"text-sm font-medium underline",style:{color:u},children:"Reset"})]}),(0,a.jsxs)("form",{ref:h,action:l.W?"".concat(l.W,"/search"):"/search",method:"get",className:"space-y-5",onChange:v,children:[c.q&&(0,a.jsx)("input",{type:"hidden",name:"q",defaultValue:c.q}),f.map(e=>(0,a.jsx)("input",{type:"hidden",name:"category",value:e},e)),(0,a.jsxs)("div",{className:"border-b border-gray-200 dark:border-gray-800 pb-4",children:[(0,a.jsx)("p",{className:"mb-2 text-sm font-medium",style:{color:m},children:"Category"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:g.map(e=>{let t=f.includes(e);return(0,a.jsx)("button",{type:"button",onClick:()=>{b(t=>{let r=t.includes(e)?t.filter(t=>t!==e):[...t,e],a=h.current;return a&&(Array.from(a.querySelectorAll('input[type="hidden"][name="category"]')).forEach(e=>e.remove()),r.forEach(e=>{let t=document.createElement("input");t.type="hidden",t.name="category",t.value=e,a.appendChild(t)}),a.dispatchEvent(new Event("change",{bubbles:!0}))),r})},className:"rounded-full px-3 py-1.5 text-sm transition shadow-sm ring-1 ".concat(t?"text-white":"bg-white text-gray-700 dark:bg-gray-900 dark:text-gray-200"),style:{backgroundColor:t?u:void 0,borderColor:t?u:"rgba(0,0,0,0.08)"},"aria-pressed":t,children:e},e)})})]}),(0,a.jsxs)("div",{className:"border-b border-gray-200 dark:border-gray-800 pb-4",children:[(0,a.jsx)("label",{htmlFor:"location",className:"mb-1 block text-sm font-medium",style:{color:m},children:"Location"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{id:"location",name:"location",placeholder:"e.g., Gym, Library",defaultValue:null!=(r=c.location)?r:"",className:"w-full rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-900  px-3 py-2 text-sm shadow-sm outline-none focus:ring-2  focus:ring-[rgba(11,44,92,0.6)] focus:border-[rgba(11,44,92,1)]"}),(0,a.jsx)("span",{className:"pointer-events-none absolute right-2 top-1/2 -translate-y-1/2 text-gray-400",children:"⌕"})]})]}),(0,a.jsxs)("div",{className:"border-b border-gray-200 dark:border-gray-800 pb-4",children:[(0,a.jsx)("p",{className:"mb-2 text-sm font-medium",style:{color:m},children:"Date range"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("div",{className:"min-w-0 flex-1",children:(0,a.jsx)("input",{type:"date",name:"date_from",defaultValue:null!=(o=c.date_from)?o:"",className:"w-full rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-900  px-3 py-2 text-sm shadow-sm outline-none focus:ring-2  focus:ring-[rgba(11,44,92,0.6)] focus:border-[rgba(11,44,92,1)]"})}),(0,a.jsx)("div",{className:"min-w-0 flex-1",children:(0,a.jsx)("input",{type:"date",name:"date_to",defaultValue:null!=(i=c.date_to)?i:"",className:"w-full rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-900  px-3 py-2 text-sm shadow-sm outline-none focus:ring-2  focus:ring-[rgba(11,44,92,0.6)] focus:border-[rgba(11,44,92,1)]"})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"sort",className:"mb-1 block text-sm font-medium",style:{color:m},children:"Sort by"}),(0,a.jsxs)("select",{id:"sort",name:"sort",defaultValue:null!=(d=c.sort)?d:"newest",className:"w-full rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-900  px-3 py-2 text-sm shadow-sm outline-none focus:ring-2  focus:ring-[rgba(11,44,92,0.6)] focus:border-[rgba(11,44,92,1)]",children:[(0,a.jsx)("option",{value:"newest",children:"Newest first"}),(0,a.jsx)("option",{value:"oldest",children:"Oldest first"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{type:"submit",className:"rounded-lg px-4 py-2 text-sm font-semibold text-white shadow-md transition hover:opacity-90",style:{backgroundColor:u},children:"Apply"}),(0,a.jsx)("button",{type:"button",onClick:j,className:"rounded-lg border px-4 py-2 text-sm font-medium hover:bg-gray-50 dark:hover:bg-gray-800",style:{borderColor:"rgba(0,0,0,.1)",color:m},children:"Reset"})]})]})]})})}l.W;let h="#BF1E2E",f="#0B2C5C";function b(e){let{title:t,kicker:r}=e;return(0,a.jsxs)("div",{className:"mb-5",children:[r&&(0,a.jsx)("div",{className:"inline-block rounded-full px-3 py-1 text-xs font-semibold tracking-wide text-white",style:{backgroundColor:f},children:r}),(0,a.jsxs)("div",{className:"mt-2 flex items-center gap-3",children:[(0,a.jsxs)("svg",{width:"28",height:"32",viewBox:"0 0 24 28","aria-hidden":!0,className:"drop-shadow-sm",children:[(0,a.jsx)("path",{d:"M12 0l10 4v8c0 7-5 12-10 16C7 24 2 19 2 12V4l10-4z",fill:h}),(0,a.jsx)("path",{d:"M12 3l7 2v6c0 5-4 9-7 12-3-3-7-7-7-12V5l7-2z",fill:"white",opacity:".95"}),(0,a.jsx)("path",{d:"M12 4.5l5 1.5v5c0 4-3.2 7-5 8.8-1.8-1.8-5-4.8-5-8.8v-5l5-1.5z",fill:f})]}),(0,a.jsx)("h2",{className:"text-2xl sm:text-3xl font-extrabold tracking-tight",style:{color:f},children:t})]}),(0,a.jsx)("div",{className:"mt-2 h-1 rounded-full",style:{background:"linear-gradient(90deg, ".concat(h,", ").concat(f,")")}})]})}function p(e){let{children:t}=e,r=encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' width='18' height='18'><circle cx='1' cy='1' r='1' fill='".concat(f,"22'/></svg>"));return(0,a.jsx)("div",{className:"rounded-3xl p-6 sm:p-8 shadow-[0_10px_30px_rgba(0,0,0,.05)]",style:{backgroundImage:'url("data:image/svg+xml,'.concat(r,'")'),backgroundColor:"#fafbff"},children:t})}function y(e){let{children:t}=e;return(0,a.jsx)("span",{className:"rounded-full bg-white px-3 py-1 text-sm shadow-sm ring-1 ring-gray-200 dark:bg-gray-900 dark:ring-gray-800",children:t})}function v(){let e=(0,n.useSearchParams)(),t=(0,s.useMemo)(()=>{var t;return(null!=(t=e.get("q"))?t:"").trim()},[e]),r=(0,s.useMemo)(()=>{var t;return(null!=(t=e.get("location"))?t:"").trim()},[e]),l=(0,s.useMemo)(()=>{var t;return(null!=(t=e.get("date_from"))?t:"").trim()},[e]),o=(0,s.useMemo)(()=>{var t;return(null!=(t=e.get("date_to"))?t:"").trim()},[e]),u="oldest"===e.get("sort")?"oldest":"newest",m=(0,s.useMemo)(()=>{let t=e.getAll("category").filter(Boolean);if(0===t.length){let t=e.get("category");if(null==t?void 0:t.includes(","))return t.split(",").map(e=>e.trim()).filter(Boolean);if(t)return[t]}return t},[e]),[g,v]=(0,s.useState)([]),[j,w]=(0,s.useState)(!1),[N,k]=(0,s.useState)(null);(0,s.useEffect)(()=>{let e=!1;return(async()=>{var a;w(!0),k(null);let s=d.N.schema("public").from("items").select("id,title,location_found,category,date_found,photo_url,status").eq("status","listed");t&&(s=s.or("title.ilike.%".concat(t,"%,location_found.ilike.%").concat(t,"%,category.ilike.%").concat(t,"%"))),m.length&&(s=s.in("category",m)),r&&(s=s.ilike("location_found","%".concat(r,"%"))),l&&(s=s.gte("date_found",l)),o&&(s=s.lte("date_found",o)),s=s.order("date_found",{ascending:"oldest"===u,nullsFirst:!1});let{data:n,error:i}=await s;if(e)return;if(i){k(i.message),w(!1);return}let c="/no-image.png";v(null!=(a=(null!=n?n:[]).map(e=>{var t,r,a,l;let s=c,n=null!=(t=e.photo_url)?t:null;if(n)if(/^https?:\/\//i.test(n))s=n;else{let{data:e}=d.N.storage.from("item-photos").getPublicUrl(n);s=(null==e?void 0:e.publicUrl)||c}return{id:String(e.id),title:String(null!=(r=e.title)?r:"Untitled"),location:String(null!=(a=e.location_found)?a:"—"),category:String(null!=(l=e.category)?l:"Misc"),date:e.date_found?new Date(e.date_found).toISOString().slice(0,10):"",thumb:s}}))?a:[]),w(!1)})(),()=>{e=!0}},[t,m,r,l,o,u]);let C=t||m.length>0||r||l||o||"oldest"===u;return(0,a.jsx)("div",{className:"min-h-screen",style:{background:"linear-gradient(180deg, #0B2C5C0A 0%, #0B2C5C08 40%, #ffffff 100%)",backgroundImage:"radial-gradient(rgba(11,44,92,0.06) 1px, transparent 1px)",backgroundSize:"18px 18px"},children:(0,a.jsxs)("section",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-10",children:[(0,a.jsx)(b,{title:"Browse Items",kicker:"Search"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-[16rem_1fr] gap-6",children:[(0,a.jsx)(x,{initial:{q:t,category:m,location:r,date_from:l,date_to:o,sort:u}}),(0,a.jsx)(p,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-2",children:[(0,a.jsx)("h1",{className:"text-xl font-semibold",style:{color:f},children:"Results"}),C&&(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[t&&(0,a.jsxs)(y,{children:["q: “",t,"”"]}),m.map(e=>(0,a.jsx)(y,{children:e},e)),r&&(0,a.jsx)(y,{children:r}),(l||o)&&(0,a.jsxs)(y,{children:[l||"…"," → ",o||"…"]}),(0,a.jsx)(i(),{href:"/search",className:"text-sm underline",style:{color:h},children:"Clear"})]})]}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:j?"Searching…":"".concat(g.length," item").concat(1===g.length?"":"s"," found")}),N&&(0,a.jsxs)("div",{className:"rounded-lg border border-red-500/30 bg-red-50 p-3 text-sm text-red-700 dark:border-red-500/40 dark:bg-red-900/20 dark:text-red-200",children:["Error: ",N]}),j||N||0!==g.length?(0,a.jsx)("ul",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:g.map(e=>(0,a.jsx)("li",{children:(0,a.jsx)(c.I,{item:e})},e.id))}):(0,a.jsx)("div",{className:"grid place-items-center rounded-2xl border border-dashed border-gray-300 py-16 text-center",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-lg font-medium",children:"No items match your filters."}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-600",children:"Try adjusting your keywords or categories."}),(0,a.jsx)(i(),{href:"/search",className:"mt-4 inline-block rounded-lg px-4 py-2 text-white",style:{backgroundColor:h},children:"Clear filters"})]})})]})})]})]})})}},4642:(e,t,r)=>{"use strict";r.d(t,{I:()=>o});var a=r(5155),l=r(2115),s=r(5229),n=r(7650);function o(e){var t;let{item:r}=e,[o,i]=l.useState(!1),[d,c]=l.useState(!1),u=l.useRef(null);return l.useEffect(()=>c(!0),[]),l.useEffect(()=>{o&&u.current&&u.current.focus()},[o]),l.useEffect(()=>{if(!o)return;let e=e=>"Escape"===e.key&&i(!1);return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[o]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("article",{role:"button",tabIndex:0,onClick:()=>i(!0),onKeyDown:e=>"Enter"===e.key&&i(!0),className:"group relative flex flex-col overflow-hidden rounded-xl border border-gray-200 bg-white shadow-sm outline-none transition hover:-translate-y-0.5 hover:shadow-md dark:border-gray-800 dark:bg-gray-950 cursor-pointer","aria-label":"View details for ".concat(r.title),children:[(0,a.jsx)("div",{className:"relative aspect-[4/3] overflow-hidden bg-gray-100 dark:bg-gray-900",children:r.thumb?(0,a.jsx)("img",{src:r.thumb,alt:r.title,className:"h-full w-full object-cover transition-transform duration-300 group-hover:scale-105",loading:"lazy"}):(0,a.jsx)("div",{className:"flex h-full w-full items-center justify-center text-sm text-gray-500 dark:text-gray-400",children:"No image"})}),(0,a.jsxs)("div",{className:"flex flex-col gap-1.5 p-4",children:[(0,a.jsx)("h3",{className:"line-clamp-1 font-medium leading-tight text-gray-900 dark:text-gray-100",children:r.title}),(0,a.jsxs)("p",{className:"line-clamp-1 text-sm text-gray-600 dark:text-gray-400",children:[r.location," • ",r.category]}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:["Found ",new Date(r.date).toLocaleDateString()]})]})]}),d&&o&&(0,n.createPortal)((0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",onMouseDown:e=>e.target===e.currentTarget&&i(!1),children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm"}),(0,a.jsxs)("div",{className:"relative z-10 grid w-[min(90vw,900px)] max-h-[90vh] grid-cols-1 overflow-hidden rounded-2xl bg-white shadow-2xl dark:bg-gray-950 md:grid-cols-2",children:[(0,a.jsxs)("div",{className:"relative group overflow-hidden bg-gray-100 dark:bg-gray-900",children:[r.thumb?(0,a.jsx)("img",{src:r.thumb,alt:r.title,className:"h-full w-full object-cover transition-transform duration-300 group-hover:scale-105"}):(0,a.jsx)("div",{className:"flex h-full w-full items-center justify-center text-gray-500",children:"No image"}),(0,a.jsx)("button",{ref:u,onClick:()=>i(!1),className:"absolute right-3 top-3 inline-flex h-9 w-9 items-center justify-center rounded-full bg-black/60 text-white transition hover:bg-black/80 focus-visible:ring-2 focus-visible:ring-white","aria-label":"Close",children:(0,a.jsx)(s.A,{className:"h-5 w-5"})})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-4 p-5 md:p-6 overflow-y-auto",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-semibold tracking-tight md:text-2xl",children:r.title}),(0,a.jsxs)("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:[r.location," • ",r.category]}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:["Found ",new Date(r.date).toLocaleDateString()]})]}),(0,a.jsxs)("div",{className:"prose max-w-none prose-p:my-3 dark:prose-invert",children:[(0,a.jsx)("h3",{className:"mb-1 text-base font-medium",children:"Description"}),(0,a.jsx)("p",{className:"text-sm leading-6",children:(null==(t=r.description)?void 0:t.trim())||"No description provided."})]}),(0,a.jsx)("div",{className:"mt-auto",children:(0,a.jsx)("button",{onClick:()=>alert("Claim flow here"),className:"rounded-xl bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700",children:"Start claim"})})]})]})]}),document.body)]})}},5229:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(1847).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},6278:(e,t,r)=>{"use strict";r.d(t,{W:()=>a});let a="/school-lost-and-found"},9526:(e,t,r)=>{Promise.resolve().then(r.bind(r,1651))}},e=>{e.O(0,[993,297,441,255,358],()=>e(e.s=9526)),_N_E=e.O()}]);